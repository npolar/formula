<fieldset ng-class="{ valid: field.valid, error: field.errors }">
  <legend>{{ field.title }}
    ({{ field.nrArrayValues() || 0 }})</legend>

  <ul ng-if="::field.typeOf('fieldset')">
    <li ng-repeat="value in field.values track by value.path" ng-if="!value.hidden">
      <fieldset ng-class="{ valid: value.valid }">
        <legend>
          <span ng-if="!value.visible">{{ value.fields | formulaInlineValues }}</span>
          <a class="toggle" href="" ng-click="field.itemToggle($index)" title="{{ value.visible ? form.i18n.minimize[1] : form.i18n.maximize[1] }}">{{ value.visible ? '_' : 'â€¾' }}</a>
          <a class="remove" href="" ng-click="field.itemRemove($index)" title="{{ form.i18n.remove[1] }}">X</a>
        </legend>

        <formula:field field="value" ng-if="value.visible"></formula:field>
      </fieldset>
    </li>
    <li>
      <span ng-if="field.errors" title="{{ field.errors.join('\n') }}">{{ form.i18n.invalid | formulaReplace : { count: field.errors.length } }}</span>
      <span ng-if="!field.errors">{{ field.description  }}</span>

      <button class="add" ng-click="field.itemAdd()" title="{{ form.i18n.add[1] }}" type="button">
        <strong>+</strong>
        {{ form.i18n.add[0] }}</button>
    </li>
  </ul>

  <ul ng-if="::field.typeOf('field')">
    <li ng-class="{ valid: value.valid, error: value.error }" ng-repeat="value in field.values track by value.path">
      <input formula:input field="value" />
      <a class="remove" href="" ng-click="field.itemRemove($index)" title="{{ form.i18n.remove[1] }}">X</a>
    </li>
    <li>
      <span ng-if="field.errors" title="{{ field.errors.join('\n') }}">{{ form.i18n.invalid | formulaReplace : { count: field.errors.length } }}</span>
      <span ng-if="!field.errors">{{ field.description  }}</span>

      <button class="add" ng-click="field.itemAdd()" title="{{ form.i18n.add[1] }}" type="button">
        <strong>+</strong>
        {{ form.i18n.add[0] }}</button>
    </li>
  </ul>
</fieldset>
